{"version":3,"file":"index.js","sources":["../src/lint.js","../src/json.js"],"sourcesContent":["/// Calls\n/// [`JSON.parse`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/parse)\n/// on the document and, if that throws an error, reports it as a\n/// single diagnostic.\nexport const jsonParseLinter = () => (view) => {\n    try {\n        JSON.parse(view.state.doc.toString());\n    }\n    catch (e) {\n        if (!(e instanceof SyntaxError))\n            throw e;\n        const pos = getErrorPosition(e, view.state.doc);\n        return [{\n                from: pos,\n                message: e.message,\n                severity: 'error',\n                to: pos\n            }];\n    }\n    return [];\n};\nfunction getErrorPosition(error, doc) {\n    let m;\n    if (m = error.message.match(/at position (\\d+)/))\n        return Math.min(+m[1], doc.length);\n    if (m = error.message.match(/at line (\\d+) column (\\d+)/))\n        return Math.min(doc.line(+m[1]).from + (+m[2]) - 1, doc.length);\n    return 0;\n}\n","import { parser } from \"lezer-json\";\nimport { continuedIndent, indentNodeProp, foldNodeProp, foldInside, LezerLanguage, LanguageSupport } from \"@codemirror/language\";\nimport { styleTags, tags as t } from \"@codemirror/highlight\";\n/// A language provider that provides JSON parsing.\nexport const jsonLanguage = LezerLanguage.define({\n    parser: parser.configure({\n        props: [\n            indentNodeProp.add({\n                Object: continuedIndent({ except: /^\\s*\\}/ }),\n                Array: continuedIndent({ except: /^\\s*\\]/ })\n            }),\n            foldNodeProp.add({\n                \"Object Array\": foldInside\n            }),\n            styleTags({\n                String: t.string,\n                Number: t.number,\n                \"True False\": t.bool,\n                PropertyName: t.propertyName,\n                null: t.null,\n                \",\": t.separator,\n                \"[ ]\": t.squareBracket,\n                \"{ }\": t.brace\n            })\n        ]\n    }),\n    languageData: {\n        closeBrackets: { brackets: [\"[\", \"{\", '\"'] },\n        indentOnInput: /^\\s*[\\}\\]]$/\n    }\n});\n/// JSON language support.\nexport function json() {\n    return new LanguageSupport(jsonLanguage);\n}\nexport { jsonParseLinter } from \"./lint\";\n"],"names":["t"],"mappings":"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"}